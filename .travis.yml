branches:
  only:
    - master
language: python
python:
  - "2.7"
  
jobs:
  - stage: syntax_check
    - python -m pip install pylint
    - pylint --generate-rcfile > .pylintrc
    - pylint sphinx-local/scripts/*.py
  - stage: test
    - python -m pip install pylint
    - pylint --generate-rcfile > .pylintrc
    - pylint sphinx-local/scripts/*.py
  - stage: install
    - pip install -U sphinx
    - git branch -D gh-pages || true
    - git push -D https://shrinilthakkar:$key@github.com/shrinilthakkar/shrinilthakkar.git/ gh-pages || true
    - git checkout -b gh-pages origin/gh-pages
    - cd sphinx-local
    - sphinx-apidoc -o ./rst/ ./scripts/
    - sphinx-build -b html ./rst/ ./html/
    - git config --global user.name "shrinilthakkar"
    - git config --global user.email "shrinil@moengage.com"
    - git add html
    - git commit -am "adding html files"
    - git push -u https://shrinilthakkar:$key@github.com/shrinilthakkar/shrinilthakkar.git/ gh-pages
